<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.owl.project.dao.ProjectDao">
	<!-- sidebar project 목록 출력 -->
	<select id="getProjectLists"  resultType="com.owl.project.dto.ProjectList" parameterType="String">
		SELECT p.PROJECTIDX, p.PROJECTNAME, l.FAVORITE, l.PROJECTCOLOR, l.AUTHORITY, l.email FROM PROJECT p JOIN PROJECTLIST l 
		ON p.PROJECTIDX=l.PROJECTIDX where l.EMAIL = #{email}
	</select>

	<!-- sidebar project 목록 수정 -->
	<update id="updateProjectList" parameterType="com.owl.project.dto.ProjectList">		
		UPDATE PROJECTLIST SET FAVORITE=#{favorite}
								, PROJECTCOLOR=#{projectColor}
		WHERE EMAIL=#{email} and PROJECTIDX=#{projectIdx}
	</update>

	<select id="getProjectList"  resultType="com.owl.project.dto.ProjectList" >
		SELECT l.PROJECTIDX, p.PROJECTNAME, l.FAVORITE, l.PROJECTCOLOR, l.AUTHORITY, l.email 
			FROM PROJECT p JOIN PROJECTLIST l 
		ON p.PROJECTIDX=l.PROJECTIDX where l.EMAIL = #{param2} AND l.PROJECTIDX = #{param1}
	</select>
	
	<!-- sidebar project 목록 삽입 -->
	<insert id="insertProject" parameterType="com.owl.project.dto.Project">
		INSERT INTO PROJECT (PROJECTIDX, PROJECTNAME) VALUES (#{projectIdx}, #{projectName})
	</insert>
	
	<insert id="insertProjectList" parameterType="com.owl.project.dto.ProjectList" useGeneratedKeys="true" keyProperty="projectIdx">
		INSERT INTO PROJECTLIST (PROJECTIDX, EMAIL, PROJECTCOLOR, AUTHORITY) VALUES (#{projectIdx}, #{email}, #{projectColor}, #{'ROLE_PM'})
	</insert>
</mapper>